#### 异或加密
nbit：明文m，密文c，密钥k
1.加密：c=m$\oplus$k
2.k重复使用-不随机现象：c=m$\oplus$k，c'=m'$\oplus$k→c$\oplus$c'=m$\oplus$m'，即密文对的异或值=明文对的异或值
3.不随机现象：
①对异或加密：$P_{r}(c\oplus c'=m\oplus m')=1$
②对随机置换：$P_r(c\oplus c'=m\oplus m')=\frac{1}{2^n}$

#### 差分分析
1.差分分析：选择明文攻击，分析迭代型分组密码安全性的重要手段
2.差分：
①异或差分：$X \oplus X'=\Delta X$
②不同的明文可以具有相同的差分值
e.g.（0000，0011）（0001，0010）（0100，0111）异或值=0011
e.g.若加密算法c=m+k(mod 26)，应定义差分c-c'(mod 26)才能消除密钥的影响（减法→消去k）
③S盒的差分传播
（1）对于DES的S盒$S_8$，以下输入对均满足输入差分为000100（共$2^6$=32对）
查表：最高位最低位-行标，中间4位-列标
000000，000100：
S(000000)$\oplus$S(000100)=1101 $\oplus$ 1000=0101
000001，000101：
S(000001)$\oplus$S(000101)=0001 $\oplus$ 1101=1100
（2）S盒的输入差分非0时，输出差分的取值不确定（非线性变换）
④差分在不同部件中的传播特性
（1）过线性变换差分值确定-确定输入差分，输出差分也确定
P为线性变换，则P(X)$\oplus$P(X')=P(X$\oplus$X')=P($\Delta X$)
（2）异或密钥差分值不变
⑤S盒的差分传播规则
- u$\oplus$u'=0xf，$P_{r}(v\oplus v'=d)=\frac{10}{16}$

3.2轮差分
若$L_0$和$L_0^*$差分=2，$R_0$和$R_0^*$差分=0，$Delta R_{3}=Delta R_{2}=\alpha$
概率=1的2轮差分：(2,0)→(2,$\Delta R_3$)
对随机置换：$P_r((2,0)→(2,\Delta R_3))=\frac{1}{2^{64}}$

4.3轮DES的密钥恢复攻击
$L_{3}=L_{2}\oplus f(K_2,R_3)$
$L_{3}'=L_{2}'\oplus f(K_2,R_{3}')$
$L_{3}\oplus L_{3}'=f(K_2,R_3)\oplus f(K_2,R_{3}')\oplus 2$
$\Delta L_{3}\oplus 2=f(K_2,R_3)\oplus f(K_2,R_{3}')$
正确密钥$K_{2,right}$以概率1满足
正确密钥$K_{2,wrong}$以概率$\frac{1}{2^{64}}$满足
**细化**


5.差分分析的原理：通过选择满足特定差分的明文对，推断差分在多轮加密过程中的变换情况
①发现长轮数、高概率的i轮差分
②建立与部分密钥有关的带概率的方程，利用正误密钥下，中间状态满足特定差分值的名密文对数服从不同分布


