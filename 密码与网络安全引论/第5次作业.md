# （一）题目
![[default (2).jpg]]
# （二）分析
## 一、女孩父亲简化后的协议
在女孩父亲简化后的协议中，双方是这样通信的：
$A→B:(A,E_{KU_{b}}[M],B)$
$B→A:(B,E_{KU_{a}}[M],A)$
只要发送方向B发送一个使用B的公钥加密的包，B就会使用其私钥解密密文$E_{KU_{b}}[M]$，并用发送者的公钥加密后发回去。
如果有一个攻击者C试图窃取消息M，首先C截获A发给B的密文$E_{KU_{b}}[M]$，但C没有B的私钥，所以无法解密，那么C可以假装自己是发送者，将截获的密文以C的名义再发给B：$C→B:(C,E_{KU_{b}}[M],B)$，B收到消息后使用其私钥解密密文$E_{KU_{b}}[M]$，并用C的公钥加密后发给C，C再使用自己的私钥解密后就可以获取消息M。
## 二、年轻人提出的协议
年轻人原来提出的协议是这样的：
$A→B:(A,E_{KU_{b}}[M,A],B)$
$B→A:(B,E_{KU_{a}}[M,B],A)$
如果攻击者C试图窃取消息M，首先C截获A发给B的密文$E_{KU_{b}}[M,A]$，然后假装自己是发送者，将截获的密文以C的名义再发给B：$C→B:(C,E_{KU_{b}}[M,A],B)$，B收到消息后使用其私钥解密密文$E_{KU_{b}}[M,A]$，发现密文里的发送者A和实际的发送者C不匹配，因此判定为有外部攻击或数据出错并终止协议，这样C就无法获取消息M了。


