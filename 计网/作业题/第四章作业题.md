# 4.1
<font color="#76923c">一组N个站点共享一个56kbps的纯ALOHA信道。每个站平均每100秒输出一个1000位帧，即使前一个帧还没有发送（例如，站可以缓冲传出帧）。N的最大值是多少</font>
$B=56*10^3bps$
$当G=0.5时,S_{max}=\frac{1}{2e}$
$\therefore N*\frac{1000}{100}\leq B*S_{max}$
$\therefore N_{max}=\frac{56*10^3*\frac{1}{2e}}{10}=\frac{2800}{e}\approx1030$

# 4.2
<font color="#76923c">大量 ALOHA 用户每秒产生 50 个请求，包括原始请求和重传请求。时间以 40 毫秒为单位进行。</font>
<font color="#76923c">（a）第一次尝试成功的几率有多大？</font>
$G=50*0.04=2$
$P_0=e^{-G}=e^{-2}$
<font color="#76923c">（b）恰好 k 次碰撞后成功发生的概率是多少？</font>
$p=(1-e^{-2})^k*e^{-2}$
<font color="#c00000">【前k次不成功&&第k+1次成功】</font>
<font color="#76923c">（c）预计需要多少次传输尝试？</font>
$n=\frac{1}{e^{-2}}=e^2\approx8$
<font color="#c00000">【</font>$E(x)=e^G$<font color="#c00000">】</font>
# 4.3  
<font color="#76923c">CSMA/CD 中争用槽的长度是多少</font>
<font color="#76923c">（a）一条 2 公里长的双引线电缆（信号传播速度为真空中信号传播速度的 82%）</font>
$v=3*10^8*0.82=2.46*10^8m/s$
$T=2*\frac{L}{v}=2*\frac{2000}{2.46*10^8}\approx1.626*10^{-5}s$
<font color="#c00000">【危险周期=2×RTT】</font>
<font color="#76923c">（b）一条 40 公里多模光纤电缆（信号传播速度为真空中信号传播速度的 65%）？</font>
$v=3*10^8*0.65=1.95*10^8m/s$
$T=2*\frac{L}{v}=2*\frac{40000}{1.95*10^8}\approx4.103*10^{-4}s$

# 4.4
<font color="#76923c">考虑五个无线电台，A、B、C、D 和 E。A 站可以与其他所有站台通信。B 可以与 A、C 和 E 通信。C 可以与 A、B 和 D 通信。D 可以与 A、C 和 E 通信。E 可以与 A、D 和 B 通信。</font>
<font color="#76923c">A→BCDE</font>
<font color="#76923c">B→ACE</font>
<font color="#76923c">C→ABD</font>
<font color="#76923c">D→ACE</font>
<font color="#76923c">E→ABD</font>
<font color="#c00000">【判断-当X→Y时，还能有哪些通信？】</font>
1. **列出所有其他可能的通信 S → R**
2. **排除以下三类通信**（直接失败）：
    - 通信中包含 X 或 Y
    - 发射者能覆盖 Y（干扰）
3. **对剩下的每对 S → R，走三步验证**：
    - ✅ R ∈ S 的覆盖圈？
    - ✅ S 是否空闲（不是接收中）？
    - ✅ 没有别的节点正在发射且能覆盖 R？
![[Pasted image 20260106100142.png]]
<font color="#76923c">（a） 当 A 向 B 发送信息时，还可能有哪些其他通信？</font>
由于A能与BCDE通信，所以当A向B发送信息时，其它站台都不能通信
<font color="#c00000">【A给B发送数据，BCDE均在A的覆盖范围内。CDE若收数据，则会同时收到A发送的数据，故不可能存在其他通信】</font>
<font color="#76923c">（b）当 B 向 A 发送信息时，还可能有哪些其他通信？</font>
和（a）同理，由于A能与BCDE通信，所以当B向A发送信息时，其它站台都不能通信
<font color="#c00000">【B给A发送数据，ACE在B的覆盖范围。</font>

<font color="#c00000">CE不能作为接收者收数据，否则会同时收到B发送的数据（被干扰）</font>

<font color="#c00000">CE作为发送方给A发送数据，会对B给A发送的数据造成干扰</font>

<font color="#c00000">C作为发送方给D发送数据，C覆盖ABD，会造成A被干扰</font>

<font color="#c00000">E作为发送方给D发送数据，E覆盖ABD，会造成A被干扰】</font>
<font color="#76923c">（c） 当 B 向 C 发送信息时，还有哪些其他通信可能？</font>
C不能通信的站台是E，不能与B通信的站台是D，所以E→D
<font color="#c00000">【B给C发送数据，ACE在B的覆盖范围。</font>

<font color="#c00000">AE不能作为接收者收数据，否则会同时收到B发送的数据（被干扰）</font>

<font color="#c00000">AE作为发送方给C发送数据，会对B给C发送的数据造成干扰</font>

<font color="#c00000">A作为发送方给D发送数据，然而A覆盖BCDE，会造成C被干扰</font>

<font color="#c00000">E作为发送方给D发送数据，E覆盖ABD，不会干扰C】</font>
# 4.5
<font color="#76923c">1个长 1 公里、10 Mbps 的 CSMA/CD LAN（非 802.3）传播速度为 200 m/μsec。该系统不允许使用中继台。数据帧长度为 256 位，包括 32 位头部、校验和及其他开销。成功传输后的第一个位槽预留给接收端捕获信道，以便发送 32 位确认帧。假设没有碰撞，有效数据率是多少（不含开销）？</font>
$D=1000m$
$B=10*10^6=10^7bps$
$v=200*10^6=2*10^8m/s$
$L=256bits$
$L_{other}=32bits$
$L_{data}=256-32=224bits$
$t_{传送数据帧}=\frac{256}{10^7}=2.56*10^{-5}s$
$t_{数据帧延迟}=\frac{1000}{2*10^8}=5*10^{-6}s$
$t_{捕获}=\frac{1}{10^7}=10^{-7}s$
$t_{ACK}=\frac{32}{10^7}=3.2*10^{-6}s$
$t_{ACK延迟}=t_{数据帧延迟}=5*10^{-6}s$
$T=t_{传送数据帧}+t_{数据帧延迟}+t_{捕获}+t_{ACK}+t_{ACK延迟}=(25.6+5+0.1+3.2+5)*10^{-6}=38.9*10^{-6}=3.89*10^{-5}s$
$B_{有效}=\frac{L_{data}}{T}=\frac{224}{3.89*10^{-5}}\approx57.584*10^5=5.758*10^6bps=5.758Mbps$

<font color="#c00000">【改】</font>
$B=10Mbps=10*10^6bps$
$D=1km=10^3m$
$v=200m/μs=200*10^6m/s$
$\therefore 2*RTT=2*\frac{10^3}{200*10^6}=2*0.5*10^{-5}=2*5*10^{-6}s=10*10^{-6}s$
$数据帧大小=256bits$
$确认帧大小=32bits$
$\therefore 有效负载=256-32=224bits$
通信：
①发送端获取信道时间=2×RTT=$10*10^{-6}s$
②发送数据帧时间=$\frac{256bits}{10*10^6bps}=25.6*10^{-6}s$
③最后一位到达接收端的传播延迟=RTT=$5*10^{-6}s$
④接收端占用信道=2×RTT=$10*10^{-6}s$
⑤传送ack=$\frac{32bits}{10*10^6bps}=3.2*10^{-6}s$
⑥ack最后一位到达接收端的传播延迟=RTT=$5*10^{-6}s$
sum=$(10+25.6+5+10+3.2+5)*10^{-6}s=58.8*10^{-6}s$
$\therefore 有效数据率=\frac{224bits}{58.8*10^{-6}s}\approx 3.81*10^6bps=3.81Mbps$


# 4.6
<font color="#76923c">以太网传输的 IP 数据包长度为 60 字节，包括所有头部。如果没有使用 LLC，以太网帧是否需要填充？如果需要，需要多少字节？</font>
经典以太网的最小帧长是64字节，其中目的地址6字节，源地址6字节，上层协议类型2字节，校验和4字节，加起来一共18字节，那么数据部分最小是46字节，小于46字节则需要填充，而60＞46，所以不需要填充。
<font color="#c00000">【以太网帧的最小长度是64字节，包括以太网帧头中的两个地址、类型/长度字段和校验和。由于头部字段占用18字节，数据包是60字节，总帧大小是78字节，超过了64字节的最小值。因此，不需要填充。】</font>

<font color="#c00000">以太网帧结构：</font>

| 字段             | 长度（字节）                                     |
| -------------- | ------------------------------------------ |
| 目的 MAC 地址      | 6                                          |
| 源 MAC 地址       | 6                                          |
| Type/Length 字段 | 2                                          |
| 数据（payload）    | 46~1500（<font color="#c00000">最少46</font>） |
| FCS（帧校验序列）     | 4                                          |
| **总长度下限**      | **64 字节**（不含前导码）                           |
# 4.7 
<font color="#76923c">考虑构建一个在1公里长、无中继器的电缆上运行、速率为1 Gbps的CSMA/CD网络。电缆中的信号速度为200,000公里/秒。最小帧大小是多少？</font>
$B=1Gbps=10^9bps$
$D=1km$
$v=200000km/s$
$t=2*\frac{1}{200000}=2*0.000005=0.00001s$
$L_{min}=B*t=10^9*10^{-5}=10^4bits$
<font color="#c00000">【对于1公里长的电缆，单程传播时间为5微秒，因此2τ=10微秒。为了使CSMA/CD工作，必须在这个时间间隔内无法传输整个帧。在1 Gbps的速率下，所有小于10,000位的帧都可以在不到10微秒的时间内完全传输，所以最小帧长为10,000位或1250字节</font>
<font color="#c00000">L/B >= 2Delay</font>
<font color="#c00000">L/1Gbps >= 2×1km/200000 km/s</font>
<font color="#c00000">L = 10000 bit】</font>
# 4.8
<font color="#76923c">考虑图 4-33（b）中通过桥 B1 和 B2 连接的扩展局域网。假设两个桥的哈希表都是空的。列出以下数据传输序列中所有将转发数据包的端口：</font>
![[Pasted image 20251125102246.png]]
<font color="#76923c">（a） A 向 C 发送一个数据包。</font>
A从B1-1发送数据包，B1的哈希表为空，所以转发给B1-2、B1-3、B1-4，数据包通过B1-3发给C。B1-4再转发给B2-4，数据包从B2-4进入B2，B2的哈希表为空，所以转发给B2-1、B2-2、B2-3
转发数据包的端口：B1-2、B1-3、B1-4、B2-1、B2-2、B2-3
哈希表：

| B1  | B2  |
| --- | --- |
| A→1 | A→4 |

【B1将在端口2、3和4上转发此数据包。B2将在端口1、2和3上转发它。】
<font color="#76923c">（b） E 向 F 发送一个数据包。</font>
E发送给集线器，集线器广播给F和B2-2，数据包从B2-2进入B2，B2的哈希表没有E，所以B2再转发给B2-1、B2-3、B2-4，再转发给B1-4，数据包从B1-4进入B1，B1的哈希表没有E，所以B1转发给B1-1、B1-2、B1-3
转发数据包的端口：B2-1、B2-3、B2-4、B1-1、B1-2、B1-3
哈希表：

| B1  | B2  |
| --- | --- |
| A→1 | A→4 |
| E→4 | E→2 |

【B2将在端口1、3和4上转发此数据包。B1将在端口1、2和3上转发它。】
<font color="#76923c">（c） F 向 E 发送一个数据包。</font>
F发送给集线器，集线器转发给E和B2-2，数据包从B2-2进入B2，B2的哈希表有E→2，说明E和F在同一条线上，所以丢弃
转发数据包的端口：无
哈希表：

| B1  | B2  |
| --- | --- |
| A→1 | A→4 |
| E→4 | E→2 |
|     | F→2 |

【B2不会将其在任何端口上转发，B1也看不到它】
<font color="#76923c">（d） G 向 E 发送一个数据包。</font>
G发送给B2-3，数据包从B2-3进入B2，B2的哈希表有E→2，所以B2转发给B2-2，E收到数据包
转发数据包的端口：B2-2
哈希表：

| B1  | B2  |
| --- | --- |
| A→1 | A→4 |
| E→4 | E→2 |
|     | F→2 |
|     | G→3 |

【B2将在端口2上转发这个数据包。B1将看不到它。】
<font color="#76923c">（e） D 向 A 发送一个数据包。</font>
D发送给B2-1，数据包通过B2-1进入B2，B2的哈希表有A→4，所以B2转发给B2-4，再转发给B1-4，数据包从B1-4进入B1，B1的哈希表有A→1，所以B1转发给B1-1
转发数据包的端口：B2-4、B1-1
哈希表：

| B1  | B2  |
| --- | --- |
| A→1 | A→4 |
| E→4 | E→2 |
| D→4 | F→2 |
|     | G→3 |
|     | D→1 |

【B2将在端口4上转发此数据包，而B1将在端口1上转发它。】
<font color="#76923c">（f） B 向 F 发送一个数据包。</font>
B发送给B1-2，数据包从B1-2进入B1，B1的哈希表没有F，所以B1转发给B1-1、B1-3、B1-4.B1-4转发给B2-4，数据包从B2-4进入B2，B2的哈希表有F→2，所以B2转发给B2-2，再转发给集线器，集线器发给E和F
转发数据包的端口：B1-1、B1-3、B1-4、B2-2
哈希表：

| B1  | B2  |
| --- | --- |
| A→1 | A→4 |
| E→4 | E→2 |
| D→4 | F→2 |
|     | G→3 |
|     | D→1 |
【B1将在端口1、3和4上转发此数据包。B2将在端口2上转发它。】
# 4.9
<font color="#76923c">存储转发交换机在处理受损帧方面相比切断交换机具有优势。解释一下它是什么。</font>
切断交换机读取到帧头的目的地址后就开始转发，此时帧末尾的校验码没有到达，所以如果出现损坏的话，切断交换机会直接转发损坏的帧，导致浪费带宽。而存储转发交换机会在接收并存储整个数据帧之后进行校验，如果结果出错则说明数据受损，可以直接丢弃该帧；如果没出错则进行转发，这样错误的数据不会被发到网络中，节省了带宽。
【存储转发交换机在转发之前会存储整个帧。帧到达后，可以验证校验和。如果帧损坏，会立即丢弃。使用快速转发时，交换机无法丢弃损坏的帧，因为在检测到错误时，帧已经消失了。试图解决问题就像在马逃走后锁马厩的门。】
## 4.10 
<font color="#76923c">在第4.7.3节提到，有些桥甚至可能不存在于生成树中。勾勒出一个可能不存在桥梁的场景。</font>
LAN1和LAN2被两个并行的网桥B1和B2同时连接，形成一个环。而因为B1的ID更小，所以选择B1作为连接LAN1和LAN2的链路，那么B2的所有端口都被阻塞，所以B2虽然物理地存在在网络中，但是不存在于生成树中。
【所有网桥都参与生成树算法，并计算一条通往根的路径。
然而，有些网桥可能不是用于在站点之间转发帧的生成树的一部分。
特别是，如果一个网桥没有任何站点直接连接到其任何端口，并且是环路的一部分，那么它就有可能不是用于转发帧的生成树的一部分。这种情况发生在连接到此网桥的所有网桥到根的最短路径不包括此网桥时。】











