# 要将当前的密码学及其协议的现实应用迁移到具备抗量子安全性的系统或协议时，你能考虑到的迁移模式/使用方式是什么？
## 一、背景
作为全球信息安全体系的基础，公钥加密算法主要基于计算复杂的数学问题，但随着量子计算技术的突破，Shor算法、Grover算法和“先收集后加密”等等给当前的密码学及其协议带来了不容小觑的威胁。因此，为了保障长期数据安全，将当前的密码学及其协议的现实应用迁移到具备抗量子安全性的系统或协议是非常有必要的。
在全球范围内，多国已积极发布后量子密码迁移相关规划与指南，如美国NIST发布了《过渡到后量子密码学标准》公开草案，提出逐步淘汰传统加密算法、采用后量子密码算法的路线图和时间表，并建议联邦机构识别和评估现有加密资产，分阶段推进迁移，计划到2030年弃用安全强度低的传统算法，在2035年前全面采用后量子密码；英国NCSC发布了《迁移到后量子密码学的时间表》，为英国各组织未来数年安全迁移到后量子密码学提供清晰路线图和关键时间节点；加拿大发布了后量子密码迁移路线图，要求联邦各部门在2026年4月前提交初步后量子密码迁移计划，并每年持续报告，高优先级系统在2031年底之前完成迁移，所有剩余系统在2035年前完成迁移；韩国MSIT发布了后量子密码总体规划，计划在2035年之前将相关密码系统转变为后量子密码；我国尚未发布后量子迁移规划，但相关机构已开展后量子密码迁移的相关研究工作。赛迪智库在《应对量子计算挑战需积极推进后量子密码研发和迁移》中提出国家层面应统筹开展为期10-15年的后量子密码研发和迁移计划。信通院发布的《后量子密码应用研究报告》系统梳理了当前阶段后量子密码的发展情况。
## 二、迁移模式
### 1.混合模式
顾名思义，混合模式就是在现有的安全协议流程中并行部署一套传统的经典密码算法和一套新型的后量子密码算法。在这一模式下，系统要求攻击者必须同时攻破这两种算法，才能解密通信内容或伪造签名，为保障数据安全提供了双重保险。
在TLS 1.3等网络协议应用中，混合模式通常采用组合密钥派生的方式，即客户端和服务器分别执行传统密钥交换和后量子加密密钥交换，生成的两个共享秘密会通过密钥导出函数进行级联或混合，最终生成唯一的会话密钥。在具体的实践中，混合密钥交换机制需要支持混合模式的客户端和服务器需与不支持混合模式的端点和中间盒兼容，在混合客户端-混合服务器、混合客户端-传统服务器、传统客户端-混合服务器这三种场景下均能正常建立连接，且理想状态下无需额外往返通信或发送重复信息。此外，混合密钥交换不应带来过高的计算开销，并需避免显著增加连接建立延迟，在任何兼容模式下都不应导致额外的通信往返。
在工程实践中，其密钥封装机制主要包含三个核心算法：
$KeyGen()$-概率性密钥生成算法，输出公钥和私钥
$Encaps(pk)$-概率性封装算法，输入公钥生成密文和共享密钥
$Decaps(sk,ct)$-解封装算法，输入私钥和密文恢复共享密钥，或返回错误值
比如，在TLS 1.3中，Diffle-Hellman密钥交换可以被建模成如下密钥封装机制：$KeyGen()$选择对应指数$x$作为私钥并计算公钥$g^x$，封装对应选择指数$y$，计算密文$g^y$和共享密钥$g^{xy}$，解封装则通过计算$g^{xy}$恢复共享密钥。
### 2.完全替换模式
与混合模式不同，完全替换模式直接停用现有的经典密码算法，全面采用后量子加密标准算法。由于去除了冗余的经典加密层，完全替换模式避开了混合模式中复杂的双算法逻辑，简化了密钥管理和协议栈的实现成本，且无需进行双重加密与解密运算，减少了CPU开销，在带宽受限的场景下只需要传输一套后量子加密公钥和密文即可，避免了混合模式带来的额外数据负担。然而，后量子加密算法的公钥和密文的尺寸通常大于经典算法，对于内存不够大的嵌入式设备，直接进行替换可能会破坏设备。并且许多后量子密码算法是在近几年被研究出来的，没有像经典密码算法那样经过长年的研究和验证，缺乏一定的基础安全性和特定参数化的安全性。此外，如果后续研究发现完全替换模式选择的后量子加密算法存在某种理论缺陷，或者该算法遭到破解，那么选择该算法的加密体系会由于没有传统算法的缓冲而崩溃。
### 3.密码敏捷型模式
根据NIST今年发布的密码敏捷性白皮书草案，密码敏捷性被定义为在保持系统可用性和安全性的同时，支持密码算法、协议和参数的无缝升级与替换的能力。其中，模块化加密架构是实现密码敏捷性的基础工程，要求将加密功能从应用逻辑中剥离，通过标准化接口形成独立的密码服务层。这种架构可用于实现抽象密码接口，定义了加密、解密、签名、认证等通用操作的统一api，使应用程序无需修改即可适配不同算法。此外，这种架构还应用在了开源密码库openHiTLS中，优化了国密算法与后量子算法的集成能力，使系统能够在不中断服务的情况下完成从传统算法到后量子算法的切换。动态协商协议是实现密码敏捷性的通信层保障。工信部在今年实施的《基于传输层密码协议的量子保密通信应用设备技术规范》中特别强调了协议协商能力的重要性，要求量子通信设备必须支持多种密钥交换算法的动态切换，而动态协商协议确保了迁移过程中新旧系统的平滑过渡。全生命周期密钥管理是实现密码敏捷性的安全核心。由于后量子加密算法的密钥尺寸比传统算法的大，并且密钥特性更多样，因此密钥管理系统必须能够同时支持后量子加密算法和传统加密算法，并且能够实现不同算法密钥之间的安全派生和转换，并根据算法安全性评估自动调整密钥生命周期。
在将当前的密码学及其协议的现实应用迁移到具备抗量子安全性的系统或协议的过程中，密码敏捷性通过算法抽象层来隔离标准变化带来的影响。在模块化架构中，应用程序可以通过抽象接口调用加密服务，而无需关心具体算法实现。当NIST标准更新时，组织只需升级底层算法模块，而无需修改应用代码。比如，采用openHiTLS架构的系统可通过替换算法插件，在保持上层接口不变的情况下支持新的后量子算法。这种隔离机制将标准变化的影响范围从整个系统缩小到单个模块，大大降低了迁移成本。
在前文提到的混合模式中，密码敏捷性框架可凭借其抽象层的优点实现对传统算法和后量子加密算法的同时部署。比如，中国商用密码体系在SM2向后量子算法迁移的过程中采用了类似的策略，即通过密码敏捷性实现国密算法与后量子算法的平滑过渡。